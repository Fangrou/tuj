<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN" "http://www.w3.org/MarkUp/Wilbur/HTML32.dtd">
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
    <meta name="GENERATOR" content="Quadralay WebWorks Publisher Standard Edition 8.0.5337.0">
    <meta name="TEMPLATEBASE" content="Dynamic HTML">
    <meta name="LASTUPDATED" content="10/04/10 19:25:50">
    <title>Scenario: Matching entries using the Q-grams and Levenshtein algorithms</title>
  </head>

  <body link="#3366CC" vlink="#9999CC" text="#000000" alink="#0000CC" bgcolor="#FFFFFF">

    <!--table width="220" border="0" align="right" cellpadding="0" cellspacing="0">
      <tr> 
        <td>
<a accesskey="4" href="tRecordMatching_Prop.html"><img id="LongDescNotReq1" src="images/prev.gif" border="0" alt="Previous" /></a><a accesskey="5" href="tReplaceList_Prop.html"><img id="LongDescNotReq2" src="images/next.gif" border="0" alt="Next" /></a>
        </td>
      </tr>
    </table-->

    <!--img src="images/wwplogo.gif" width="122" height="63" alt="Put your logo here!">
    <hr align="left"-->

    <blockquote>
<a name="wp3540430"> </a><div style="color: #000000; font-size: 12pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 0pt; margin-left: 0pt; margin-right: 0pt; margin-top: 0pt; text-align: left; text-decoration: none; text-indent: 0pt; text-transform: none">

</div>
<a name="wp3540435"> </a><h2 class="pHeading2">
Scenario: Matching entries using the Q-grams and Levenshtein algorithms
</h2>
<a name="wp3540441"> </a><p class="pIndented1">
This Java scenario describes a six-component Job that aims at:
</p>
<div class="pSmartList1"><ul class="pSmartList1">
<div class="pSmartList2"><ul class="pSmartList2">
<a name="wp3540449"> </a><div class="pSmartList2"><li> matching entries in the <em class="cEmphasis">name</em> column against the entries in the reference input file by dividing strings into letter blocks of length q, where q is three, in order to create a number of q length grams. The matching result is given as the number of q-gram matches over possible q-grams,</li></div>
<a name="wp3540456"> </a><div class="pSmartList2"><li>checking the edit distance between the entries in the <em class="cEmphasis">email</em> column of an input file against those of the reference input file.</li></div>
</ul></div>
</ul></div>
<a name="wp3540461"> </a><p class="pIndented1">
The outputs of these two matching types are written in three output files: the first for match values, the second for possible match values and the third for the values for which there are no matches in the lookup file. 
</p>
<a name="wp3540465"> </a><p class="pIndented1">
In this scenario, we have already stored the main and reference input schemas in the Repository. For more information about storing schema metadata in the Repository, see <em class="cEmphasis">Setting up a DB connection</em> in <b class="cBold">Talend Integration Suite Studio</b> <b class="cBold">User Guide</b>.
</p>
<a name="wp3540499"> </a><p class="pIndented1">
The main input table contains seven columns: <em class="cEmphasis">code</em>, <em class="cEmphasis">name</em>, <em class="cEmphasis">address</em>, <em class="cEmphasis">zipcode</em>, <em class="cEmphasis">city</em>, <em class="cEmphasis">email</em> and <em class="cEmphasis">col7</em>. We want to carry the fuzzy match on two columns: <em class="cEmphasis">name</em> and <em class="cEmphasis">email</em>.
</p>
<div class="pSmartList1"><ul class="pSmartList1">
<div class="pSmartList2"><ul class="pSmartList2">
<a name="wp3540520"> </a><div class="pSmartList2"><li>In the <b class="cBold">Repository</b> tree view, expand <b class="cBold">Metadata</b> - <b class="cBold">DB Connections</b> where you have stored the main input schemas and drop the relevant file onto the design workspace.<br />The <b class="cBold">[Components]</b> dialog box displays with the corresponding component selected by default.</li></div>
</ul></div>
</ul></div>
<a name="wp3540532"> </a><div style="color: #000000; font-size: 2pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 0pt; margin-left: 0pt; margin-right: 0pt; margin-top: 0pt; text-align: left; text-decoration: none; text-indent: 0pt; text-transform: none">
</div>
<div align="center"><img src="../Images/Use_Case_tRecordMatching.png" id="wp3540529" border="0" hspace="0" vspace="0"/></div><div style="color: #000000; font-size: 2pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 0pt; margin-left: 0pt; margin-right: 0pt; margin-top: 0pt; text-align: left; text-decoration: none; text-indent: 0pt; text-transform: none">

</div>
<div class="pSmartList1"><ul class="pSmartList1">
<div class="pSmartList2"><ul class="pSmartList2">
<a name="wp3540543"> </a><div class="pSmartList2"><li>Click <b class="cBold">OK</b> to drop the <b class="cBold">tMysqlInput</b> component onto the workspace. The input table used in this scenario is called <em class="cEmphasis">person</em>. It holds several columns including the two columns <em class="cEmphasis">name</em> and <em class="cEmphasis">email</em> we want to do the fuzzy match on.</li></div>
<a name="wp3540559"> </a><div class="pSmartList2"><li>Do the same for the second input table you want to use as a reference, <em class="cEmphasis">customer </em>in this scenario.</li></div>
<a name="wp3540566"> </a><div class="pSmartList2"><li>Drop the following components from the <b class="cBold">Palette</b> onto the design workspace: <b class="cBold">tRecordMatching</b> and <b class="cBold">tLogRow</b> (x3).</li></div>
</ul></div>
</ul></div>
<a name="wp3540581"> </a><div style="color: #000000; font-size: 2pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 0pt; margin-left: 0pt; margin-right: 0pt; margin-top: 0pt; text-align: left; text-decoration: none; text-indent: 0pt; text-transform: none">
</div>
<div align="center"><img src="../Images/Use_Case_tRecordMatching1.png" id="wp3540578" border="0" hspace="0" vspace="0"/></div><div style="color: #000000; font-size: 2pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 0pt; margin-left: 0pt; margin-right: 0pt; margin-top: 0pt; text-align: left; text-decoration: none; text-indent: 0pt; text-transform: none">

</div>
<div class="pSmartList1"><ul class="pSmartList1">
<div class="pSmartList2"><ul class="pSmartList2">
<a name="wp3540592"> </a><div class="pSmartList2"><li>Connect the main and reference input components to <b class="cBold">tRecordMatching</b> using <b class="cBold">Main</b> links. The link between the reference input table and <b class="cBold">tRecordMatching</b> displays as a <b class="cBold">Lookup</b> link on the design workspace.</li></div>
<a name="wp3540613"> </a><div class="pSmartList2"><li>Connect <b class="cBold">tRecordMatching</b> to the three <b class="cBold">tLogRow </b>components using the <b class="cBold">Matches</b>, <b class="cBold">Possible Matches</b> and <b class="cBold">Non Matches</b> links.</li></div>
<a name="wp3540623"> </a><div class="pSmartList2"><li>Double-click the main and reference input database components to display their <b class="cBold">Basic settings</b> views.<br />The below capture illustrate the properties of the  <em class="cEmphasis">person</em> input table.</li></div>
</ul></div>
</ul></div>
<a name="wp3540639"> </a><div style="color: #000000; font-size: 2pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 0pt; margin-left: 0pt; margin-right: 0pt; margin-top: 0pt; text-align: left; text-decoration: none; text-indent: 0pt; text-transform: none">
</div>
<div align="center"><img src="../Images/Use_Case_tRecordMatching2.png" id="wp3540636" border="0" hspace="0" vspace="0"/></div><div style="color: #000000; font-size: 2pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 0pt; margin-left: 0pt; margin-right: 0pt; margin-top: 0pt; text-align: left; text-decoration: none; text-indent: 0pt; text-transform: none">

</div>
<a name="wp3540649"> </a><p class="pIndented1">
The below capture illustrate the properties of the  <em class="cEmphasis">customer</em> input table.
</p>
<a name="wp3540656"> </a><div style="color: #000000; font-size: 2pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 0pt; margin-left: 0pt; margin-right: 0pt; margin-top: 0pt; text-align: left; text-decoration: none; text-indent: 0pt; text-transform: none">
</div>
<div align="center"><img src="../Images/Use_Case_tRecordMatching3.png" id="wp3540653" border="0" hspace="0" vspace="0"/></div><div style="color: #000000; font-size: 2pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 0pt; margin-left: 0pt; margin-right: 0pt; margin-top: 0pt; text-align: left; text-decoration: none; text-indent: 0pt; text-transform: none">

</div>
<a name="wp3540662"> </a><p class="pIndented1">
The property fields for both <b class="cBold">tMysqlInput</b> components are automatically filled in. If you do not define your input schemas locally in the Repository, fill in the details manually after selecting <b class="cBold">Built-in</b> in the <b class="cBold">Schema Type</b> and <b class="cBold">Property Type</b> fields.
</p>
<div class="pSmartList1"><ul class="pSmartList1">
<div class="pSmartList2"><ul class="pSmartList2">
<a name="wp3540685"> </a><div class="pSmartList2"><li>Double-click <b class="cBold">tRecordMatching</b> to display its <b class="cBold">Basic settings</b> view and define its properties.</li></div>
</ul></div>
</ul></div>
<a name="wp3540692"> </a><div style="color: #000000; font-size: 2pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 0pt; margin-left: 0pt; margin-right: 0pt; margin-top: 0pt; text-align: left; text-decoration: none; text-indent: 0pt; text-transform: none">
</div>
<div align="center"><img src="../Images/Use_Case_tRecordMatching4.png" id="wp3540689" border="0" hspace="0" vspace="0"/></div><div style="color: #000000; font-size: 2pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 0pt; margin-left: 0pt; margin-right: 0pt; margin-top: 0pt; text-align: left; text-decoration: none; text-indent: 0pt; text-transform: none">

</div>
<div class="pSmartList1"><ul class="pSmartList1">
<div class="pSmartList2"><ul class="pSmartList2">
<a name="wp3540700"> </a><div class="pSmartList2"><li>Click the <b class="cBold">Edit schema</b> button to open a dialog box. Here you can define the data you want to pass to the output components.</li></div>
</ul></div>
</ul></div>
<a name="wp3540709"> </a><div style="color: #000000; font-size: 2pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 0pt; margin-left: 0pt; margin-right: 0pt; margin-top: 0pt; text-align: left; text-decoration: none; text-indent: 0pt; text-transform: none">
</div>
<div align="center"><img src="../Images/Use_Case_tRecordMatching5.png" id="wp3540706" border="0" hspace="0" vspace="0"/></div><div style="color: #000000; font-size: 2pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 0pt; margin-left: 0pt; margin-right: 0pt; margin-top: 0pt; text-align: left; text-decoration: none; text-indent: 0pt; text-transform: none">

</div>
<a name="wp3540721"> </a><p class="pIndented1">
In this example we want to pass to the <b class="cBold">tRecordMatching</b> component the <em class="cEmphasis">name</em> and <em class="cEmphasis">email</em> columns from the first <b class="cBold">tMysqlInput</b> component, and the <em class="cEmphasis">ref_name</em> and <em class="cEmphasis">ref_</em><em class="cEmphasis">email</em> columns from the second <b class="cBold">tMysqlInput</b> component.
</p>
<a name="wp3540749"> </a><p class="pBodyRelative">
</p>
<div><table border="0" cellpadding="0" cellspacing="0" align="left"><img src="../Images/bulb_small.png" align="left" id="wp3540741" border="0" hspace="0" vspace="0"/></table></div><p class="pBodyRelative">
The <em class="cEmphasis">MATCHING_DISTANCE</em> and the <em class="cEmphasis">MATCHING_WEIGHT</em> columns in the output schema are defined by default.
</p>
<a name="wp3540762"> </a><p class="pIndented1">
The <em class="cEmphasis">MATCHING_WEIGHT</em> column is always between <em class="cEmphasis">0</em> and <em class="cEmphasis">1</em>. It is a global distance between sets of columns (defined by the columns to be matched). 
</p>
<a name="wp3540769"> </a><p class="pIndented1">
The <em class="cEmphasis">MATCHING_DISTANCE</em> column will print a distance for each of the columns on which we use an algorithm. The results will be separated by a vertical bar (pipe).
</p>
<div class="pSmartList1"><ul class="pSmartList1">
<div class="pSmartList2"><ul class="pSmartList2">
<a name="wp3540779"> </a><div class="pSmartList2"><li>Click <b class="cBold">OK</b> to close the dialog box and proceed to the next step.</li></div>
<a name="wp3540791"> </a><div class="pSmartList2"><li>In the <b class="cBold">Key Definition</b> area of the <b class="cBold">Basic settings</b> view of <b class="cBold">tRecordMatching</b>, click the plus button to add two columns to the list.</li></div>
<a name="wp3540795"> </a><div class="pSmartList2"><li>Select the input columns and the output columns you want to do the fuzzy matching on from the <b class="cBold">Input key attribute</b> and <b class="cBold">Lookup key attribute</b> lists respectively. <br />In this example, select <em class="cEmphasis">name</em> and <em class="cEmphasis">email </em>as input attributes and <em class="cEmphasis">ref-name</em> and <em class="cEmphasis">ref_email</em> as lookup attributes.</li></div>
<a name="wp3540823"> </a><div class="pSmartList2"><li>Click in the <b class="cBold">Matching type</b> column and select from the list <b class="cBold">q-gram</b>, the method to be used on the first column to check the incoming data against the reference data.</li></div>
<a name="wp3540832"> </a><div class="pSmartList2"><li>Set the matching type for the second column, <b class="cBold">Levenshtein</b> in this example.</li></div>
<a name="wp3540840"> </a><p class="pBodyRelative">
<br />
<img src="../Images/bulb_small.png" align="left" id="wp3540836" border="0" hspace="0" vspace="0"/><br />
The minimum and maximum possible match values are defined in the <b class="cBold">Advanced settings</b> view. You can change the by-default values.
</p>
<a name="wp3540850"> </a><div class="pSmartList2"><li>In the <b class="cBold">Confidence Weight</b> column, set a numerical weight for each of the columns used as key attributes.</li></div>
<a name="wp3540857"> </a><div class="pSmartList2"><li>If required, click the plus button below the <b class="cBold">Blocking Definition</b> table to add one or more lines in the table and then click in the line and select from the list the column you want to use as a blocking value. <br />Using a blocking value reduces the number of pairs of records that needs to be examined. The input data is partitioned into exhaustive blocks based on the blocking value. This will decrease the number of pairs to compare as comparison is restricted to record pairs within each block. Check <a href="tGenKey_Scenario.html#wp3531640"><em class="cEmphasis">Scenario2: Comparing columns and grouping in the output flow duplicate records that have the same functional key</em></a> for a use case of the blocking value. </li></div>
<a name="wp3540870"> </a><div class="pSmartList2"><li>Double-click the first <b class="cBold">tLogRow </b>component to display its <b class="cBold">Basic settings</b> view and define its properties.</li></div>
</ul></div>
</ul></div>
<a name="wp3540879"> </a><div style="color: #000000; font-size: 2pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 0pt; margin-left: 0pt; margin-right: 0pt; margin-top: 0pt; text-align: left; text-decoration: none; text-indent: 0pt; text-transform: none">
</div>
<div align="center"><img src="../Images/Use_Case_tBlockedFuzzyJoin5.png" id="wp3540876" border="0" hspace="0" vspace="0"/></div><div style="color: #000000; font-size: 2pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 0pt; margin-left: 0pt; margin-right: 0pt; margin-top: 0pt; text-align: left; text-decoration: none; text-indent: 0pt; text-transform: none">

</div>
<div class="pSmartList1"><ul class="pSmartList1">
<div class="pSmartList2"><ul class="pSmartList2">
<a name="wp3540893"> </a><div class="pSmartList2"><li>In the <b class="cBold">Mode</b> area, select <b class="cBold">Table</b> to display the source file and the <b class="cBold">tRecordMatching</b> results together to be able to compare them.</li></div>
<a name="wp3540901"> </a><div class="pSmartList2"><li>Do the same for the other two<b class="cBold"> tLogRow</b> components.</li></div>
<a name="wp3540909"> </a><div class="pSmartList2"><li>Save your Job and press <b class="cBold">F6</b> to execute it.</li></div>
</ul></div>
</ul></div>
<a name="wp3540912"> </a><p class="pIndented1">
Three output tables are written on the console. The first shows the match entries, the second show the possible match entries and the third shows the non match entries according to the used matching method in the defined columns.
</p>
<a name="wp3540917"> </a><p class="pIndented1">
The figure below illustrates extractions of the three output tables.
</p>
<a name="wp3540927"> </a><div style="color: #000000; font-size: 2pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 0pt; margin-left: 0pt; margin-right: 0pt; margin-top: 0pt; text-align: left; text-decoration: none; text-indent: 0pt; text-transform: none">
</div>
<div align="center"><img src="../Images/Components-04-58-225.jpg" height="681" width="1050" id="wp3540921" border="0" hspace="0" vspace="0"/></div><div style="color: #000000; font-size: 2pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 0pt; margin-left: 0pt; margin-right: 0pt; margin-top: 0pt; text-align: left; text-decoration: none; text-indent: 0pt; text-transform: none">

</div>
<a name="wp3540930"> </a><p class="pIndented1">
The first table lists all the names and emails that could be matched with identical entries in the reference table. Thus the matching distance and the matching weight are equal to &quot;1.0&quot;. 
</p>
<a name="wp3540934"> </a><p class="pIndented1">
The second table lists all the names and emails that have a possible match in the reference table. The matching distance column prints the distances for the <em class="cEmphasis">name</em> and <em class="cEmphasis">email</em> columns and separate them by a vertical bar.
</p>
<a name="wp3540947"> </a><p class="pIndented1">
The third table lists all the names and emails that do not have match in the reference table.
</p>
    </blockquote>
    <hr>

    <!--table align="right" border="0" cellspacing="0" cellpadding="0">
      <tr>
        <td align="right"><font size="1">
          <a href="http://www.webworks.com"><img src="images/webworks.gif" width="150" height="20" border="0"></a><br>
            Quadralay Corporation<br>
            http://www.webworks.com<br>
            Voice: (512) 719-3399<br>
            Fax: (512) 719-3606<br>
          <a href="mailto:sales@webworks.com">sales@webworks.com</a><br>
        </font></td>
      </tr>
    </table-->

    <!--table width="220" border="0" cellpadding="0" cellspacing="0">
      <tr> 
        <td>
<a accesskey="4" href="tRecordMatching_Prop.html"><img id="LongDescNotReq3" src="images/prev.gif" border="0" alt="Previous" /></a><a accesskey="5" href="tReplaceList_Prop.html"><img id="LongDescNotReq4" src="images/next.gif" border="0" alt="Next" /></a>
        </td>
      </tr>
    </table-->
  </body>
</html>
