<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN" "http://www.w3.org/MarkUp/Wilbur/HTML32.dtd">
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
    <meta name="GENERATOR" content="Quadralay WebWorks Publisher Standard Edition 8.0.5337.0">
    <meta name="TEMPLATEBASE" content="Dynamic HTML">
    <meta name="LASTUPDATED" content="10/04/10 19:26:00">
    <title>Scenario 1: Removing and regenerating a MySQL table index</title>
  </head>

  <body link="#3366CC" vlink="#9999CC" text="#000000" alink="#0000CC" bgcolor="#FFFFFF">

    <!--table width="220" border="0" align="right" cellpadding="0" cellspacing="0">
      <tr> 
        <td>
<a accesskey="4" href="tMysqlRow_Prop.html"><img id="LongDescNotReq1" src="images/prev.gif" border="0" alt="Previous" /></a><a accesskey="5" href="Components05-276.html"><img id="LongDescNotReq2" src="images/next.gif" border="0" alt="Next" /></a>
        </td>
      </tr>
    </table-->

    <!--img src="images/wwplogo.gif" width="122" height="63" alt="Put your logo here!">
    <hr align="left"-->

    <blockquote>
<a name="wp1383846"> </a><div style="color: #000000; font-size: 12pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 0pt; margin-left: 0pt; margin-right: 0pt; margin-top: 0pt; text-align: left; text-decoration: none; text-indent: 0pt; text-transform: none">

</div>
<a name="wp1383853"> </a><h2 class="pHeading2">
Scenario 1: Removing and regenerating a MySQL table index
</h2>
<a name="wp1365427"> </a><p class="pIndented1">
This scenario describes a four-component job that removes a table index, applies a select insert action onto a table then regenerates the index.
</p>
<a name="wp1365435"> </a><div style="color: #000000; font-size: 2pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 0pt; margin-left: 0pt; margin-right: 0pt; margin-top: 0pt; text-align: left; text-decoration: none; text-indent: 0pt; text-transform: none">
</div>
<div align="center"><img src="../Images/Use_Case_tMySQLRow.png" id="wp1365432" border="0" hspace="0" vspace="0"/></div><div style="color: #000000; font-size: 2pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 0pt; margin-left: 0pt; margin-right: 0pt; margin-top: 0pt; text-align: left; text-decoration: none; text-indent: 0pt; text-transform: none">

</div>
<div class="pSmartList1"><ul class="pSmartList1">
<div class="pSmartList2"><ul class="pSmartList2">
<a name="wp1365443"> </a><div class="pSmartList2"><li>Select and drop the following components onto the design workspace: <b class="cBold">tMysqlRow</b> (x2), <b class="cBold">tRowGenerator</b>, and <b class="cBold">tMysqlOutput</b>.</li></div>
<a name="wp2167714"> </a><div class="pSmartList2"><li>Connect <b class="cBold">tRowGenerator</b> to <b class="cBold">tMysqlIntput</b>.</li></div>
<a name="wp2167777"> </a><div class="pSmartList2"><li>Using a <b class="cBold">OnComponentOk</b> connections, link the first <b class="cBold">tMysqlRow</b> to <b class="cBold">tRowGenerator</b> and <b class="cBold">tRowGenerator</b> to the second <b class="cBold">tMysqlRow</b>.</li></div>
<a name="wp2167750"> </a><div class="pSmartList2"><li>Select the <b class="cBold">tMysqlRow</b> to fill in the DB <b class="cBold">Basic settings</b>. </li></div>
<a name="wp1365506"> </a><div class="pSmartList2"><li>In <b class="cBold">Property type </b>as well in <b class="cBold">Schema</b>, select the relevant DB entry in the list.</li></div>
<a name="wp1365510"> </a><div class="pSmartList2"><li>The DB connection details and the table schema are accordingly filled in. </li></div>
<a name="wp1365514"> </a><div class="pSmartList2"><li>Propagate the properties and schema details onto the other components of the job.</li></div>
<a name="wp1365520"> </a><div class="pSmartList2"><li>The query being stored in the <b class="cBold">Metadata</b> area of the <b class="cBold">Repository</b>, you can also select <b class="cBold">Repository</b> in the <b class="cBold">Query type</b> field and the relevant query entry. </li></div>
<a name="wp1365533"> </a><div class="pSmartList2"><li>If you didn&#39;t store your query in the <b class="cBold">Repository</b>, type in the following SQL statement to alter the database entries: drop index &lt;index_name&gt; on &lt;table_name&gt; </li></div>
<a name="wp1365541"> </a><div class="pSmartList2"><li>Select the second <b class="cBold">tMysqlRow</b> component, check the DB properties and schema.</li></div>
<a name="wp1365544"> </a><div class="pSmartList2"><li>Type in the SQL statement to recreate an index on the table using the following statement: create index &lt;index_name&gt; on &lt;table_name&gt; (&lt;column_name&gt;)<br />The <b class="cBold">tRowGenerator</b> component is used to generate automatically the columns to be added to the DB output table defined.</li></div>
<a name="wp1365558"> </a><div class="pSmartList2"><li>Select the <b class="cBold">tMysqlOutput</b> component and fill in the DB connection properties either from the Repository or manually the DB connection details are specific for this use only. The table to be fed is named: <em class="cEmphasis">comprehensive</em>.</li></div>
<a name="wp1365565"> </a><div class="pSmartList2"><li>The schema should be automatically inherited from the data flow coming from the <b class="cBold">tLogRow</b>. Edit the schema to check its structure and check that it corresponds to the schema expected on the DB table specified.</li></div>
<a name="wp1365585"> </a><div class="pSmartList2"><li>The <b class="cBold">Action on table</b> is <em class="cEmphasis">None</em> and the <b class="cBold">Action on data</b> is <em class="cEmphasis">Insert</em>. </li></div>
<a name="wp1365589"> </a><div class="pSmartList2"><li>No additional Columns is required for this job.</li></div>
<a name="wp1365597"> </a><div class="pSmartList2"><li>Press <b class="cBold">F6</b> to run the job.</li></div>
</ul></div>
</ul></div>
<a name="wp1365600"> </a><p class="pIndented1">
If you manage to watch the action on DB data, you can notice that the index is dropped at the start of the job and recreated at the end of the insert action.
</p>
<a name="wp1413565"> </a><p class="pIndented1">
Related topics: <a href="tDBSQLRow_Prop.html#wp1447255"><em class="cEmphasis">tDBSQLRow properties</em></a>.
</p>
<a name="wp3014938"> </a><h2 class="pHeading2">
Scénario 2: Using PreparedStatement objects to query data
</h2>
<a name="wp3014942"> </a><p class="pIndented1">
This scenario describes a four component job which allows you to link a table column with a client file. The MySQL table contains a list of all the American States along with the State ID, while the file contains the customer information including the ID of the State in which they live. We want to retrieve the name of the State for each client, using an SQL query.  In order to process a large volume of data quickly, we use a PreparedStatement object which means that the query is executed only once rather than against each row in turn. Then each row is sentas a parameter. 
</p>
<a name="wp3015969"> </a><p class="pIndented1">
For this scenario, we use a file and a database for which we have already stored the connection and properties in the Rerpository metadata. For further information concerning the creation of metadata in delimited files, consult <em class="cEmphasis">Setting up a File Delimited schema</em>. For further information concerning the creation of database connection metadata, see <em class="cEmphasis">Setting up a DB connection</em> and for further information as to the usage of metadata, see <em class="cEmphasis">How to set a repository schema</em>. These sections are all in the <b class="cBold">Talend Integration Suite Studio</b> <b class="cBold">Components User Guide</b>.
</p>
<a name="wp3014969"> </a><div style="color: #000000; font-size: 2pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 0pt; margin-left: 0pt; margin-right: 0pt; margin-top: 0pt; text-align: left; text-decoration: none; text-indent: 0pt; text-transform: none">
</div>
<div align="center"><img src="../Images/Use_Case_tMySQLRow2_1.png" id="wp3014966" border="0" hspace="0" vspace="0"/></div><div style="color: #000000; font-size: 2pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 0pt; margin-left: 0pt; margin-right: 0pt; margin-top: 0pt; text-align: left; text-decoration: none; text-indent: 0pt; text-transform: none">

</div>
<div class="pSmartList1"><ul class="pSmartList1">
<div class="pSmartList2"><ul class="pSmartList2">
<a name="wp3014984"> </a><div class="pSmartList2"><li>In the <b class="cBold">Repository</b>, expand the <b class="cBold">Metadata</b> and <b class="cBold">File delimited</b> nodes.</li></div>
<a name="wp3014987"> </a><div class="pSmartList2"><li>Select the metadata which corresponds to the client file you want to use in the Job. Here, we are using the <em class="cEmphasis">customers</em> metadata.</li></div>
<a name="wp3014994"> </a><div class="pSmartList2"><li>Slide the metadata onto the workspace and double-click <b class="cBold">tFileInputDelimited</b> in the <b class="cBold">Components</b> dialog box so that the <b class="cBold">tFileInputDelimited</b> component is created with the parameters already set.</li></div>
</ul></div>
</ul></div>
<a name="wp3015010"> </a><div style="color: #000000; font-size: 2pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 0pt; margin-left: 0pt; margin-right: 0pt; margin-top: 0pt; text-align: left; text-decoration: none; text-indent: 0pt; text-transform: none">
</div>
<div align="center"><img src="../Images/Use_Case_tMySQLRow2_2.png" id="wp3015007" border="0" hspace="0" vspace="0"/></div><div style="color: #000000; font-size: 2pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 0pt; margin-left: 0pt; margin-right: 0pt; margin-top: 0pt; text-align: left; text-decoration: none; text-indent: 0pt; text-transform: none">

</div>
<div class="pSmartList1"><ul class="pSmartList1">
<div class="pSmartList2"><ul class="pSmartList2">
<a name="wp3015021"> </a><div class="pSmartList2"><li>In the <b class="cBold">Schema</b> list, select <b class="cBold">Built-in</b> so that you can modify the component&#39;s schema. Then click on <b class="cBold">[...]</b> next to the <b class="cBold">Edit schema</b> field to add a column into which the name of the State will be inserted.</li></div>
</ul></div>
</ul></div>
<a name="wp3015036"> </a><div style="color: #000000; font-size: 2pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 0pt; margin-left: 0pt; margin-right: 0pt; margin-top: 0pt; text-align: left; text-decoration: none; text-indent: 0pt; text-transform: none">
</div>
<div align="center"><img src="../Images/Use_Case_tMySQLRow2_3.png" id="wp3015033" border="0" hspace="0" vspace="0"/></div><div style="color: #000000; font-size: 2pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 0pt; margin-left: 0pt; margin-right: 0pt; margin-top: 0pt; text-align: left; text-decoration: none; text-indent: 0pt; text-transform: none">

</div>
<div class="pSmartList1"><ul class="pSmartList1">
<div class="pSmartList2"><ul class="pSmartList2">
<a name="wp3015044"> </a><div class="pSmartList2"><li>Click on the <b class="cBold">[+]</b> button to add a column to the schema. Rename this column <em class="cEmphasis">LabelStateRecordSet</em> and select <b class="cBold">Object</b> from the <b class="cBold">Type</b> list. Click <b class="cBold">OK</b> to save your modifications.</li></div>
<a name="wp3015069"> </a><div class="pSmartList2"><li>From the <b class="cBold">Palette</b>, select the <b class="cBold">tMysqlRow</b>, <b class="cBold">tParseRecordSet</b> and <b class="cBold">tFileOutputDelimited</b> components and drop them onto the workspace.</li></div>
<a name="wp3015083"> </a><div class="pSmartList2"><li>Connect the four components using <b class="cBold">Row</b> &gt; <b class="cBold">Main</b> type links.</li></div>
<a name="wp3015089"> </a><div class="pSmartList2"><li>Double click <b class="cBold">tMysqlRow</b> to set its properties in the <b class="cBold">Basic settings</b> tab of the <b class="cBold">Component</b> view. </li></div>
</ul></div>
</ul></div>
<a name="wp3015104"> </a><div style="color: #000000; font-size: 2pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 0pt; margin-left: 0pt; margin-right: 0pt; margin-top: 0pt; text-align: left; text-decoration: none; text-indent: 0pt; text-transform: none">
</div>
<div align="center"><img src="../Images/Use_Case_tMySQLRow2_4.png" id="wp3015101" border="0" hspace="0" vspace="0"/></div><div style="color: #000000; font-size: 2pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 0pt; margin-left: 0pt; margin-right: 0pt; margin-top: 0pt; text-align: left; text-decoration: none; text-indent: 0pt; text-transform: none">

</div>
<div class="pSmartList1"><ul class="pSmartList1">
<div class="pSmartList2"><ul class="pSmartList2">
<a name="wp3015115"> </a><div class="pSmartList2"><li>In the <b class="cBold">Property Type</b> list, select<b class="cBold"> Repository</b> and click on the <b class="cBold">[...] </b>button to select a database connection from the metadata in the Repository. The <b class="cBold">DB Version</b>, <b class="cBold">Host</b>, <b class="cBold">Port</b>, <b class="cBold">Database</b>, <b class="cBold">Username</b> and <b class="cBold">Password</b> fields are completed automatically. If you are using the <b class="cBold">Built-in</b> mode, complete these fields manually.</li></div>
<a name="wp3015146"> </a><div class="pSmartList2"><li>From the <b class="cBold">Schema</b> list, select <b class="cBold">Built-in</b> to set the schema properties manually and add the <em class="cEmphasis">LabelStateRecordSet</em> column, or click directly on the <b class="cBold">Sync columns</b> button to retrieve the schemma from the preceding component.</li></div>
<a name="wp3015157"> </a><div class="pSmartList2"><li>In the <b class="cBold">Query</b> field, enter the SQL query you want to use. Here, we want to retrieve the names of the American States from the <em class="cEmphasis">LabelState</em> column of the MySQL table,  <em class="cEmphasis">us_state</em>: <code class="cCode">&quot;SELECT LabelState FROM us_state WHERE idState=?&quot;</code>. The question mark, &quot;<code class="cCode">?</code>&quot;, represents the parameter to be set in the <b class="cBold">Advanced settings</b> tab.</li></div>
<a name="wp3015181"> </a><div class="pSmartList2"><li>Click <b class="cBold">Advanced settings</b> to set the components advanced properties. </li></div>
</ul></div>
</ul></div>
<a name="wp3015191"> </a><div style="color: #000000; font-size: 2pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 0pt; margin-left: 0pt; margin-right: 0pt; margin-top: 0pt; text-align: left; text-decoration: none; text-indent: 0pt; text-transform: none">
</div>
<div align="center"><img src="../Images/Use_Case_tMySQLRow2_5.png" id="wp3015188" border="0" hspace="0" vspace="0"/></div><div style="color: #000000; font-size: 2pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 0pt; margin-left: 0pt; margin-right: 0pt; margin-top: 0pt; text-align: left; text-decoration: none; text-indent: 0pt; text-transform: none">

</div>
<div class="pSmartList1"><ul class="pSmartList1">
<div class="pSmartList2"><ul class="pSmartList2">
<a name="wp3015202"> </a><div class="pSmartList2"><li>Select the <b class="cBold">Propagate QUERY&#39;s recordset</b> check box and select the <em class="cEmphasis">LabelStateRecordSet</em> column from the <b class="cBold">use column</b> list to insert the query results in that column.</li></div>
<a name="wp3015218"> </a><div class="pSmartList2"><li>Select the <b class="cBold">Use PreparedStatement</b> check box and define the parameter used in the query in the <b class="cBold">Set PreparedStatement Parameters</b> table.</li></div>
<a name="wp3015230"> </a><div class="pSmartList2"><li>Click on the <b class="cBold">[+]</b> button to add a parameter. </li></div>
<a name="wp3015238"> </a><div class="pSmartList2"><li>In the <b class="cBold">Parameter Index</b> cell, enter the parameter position in the SQL instruction. Enter &quot;<em class="cEmphasis">1</em>&quot; as we are only using one parameter in this example. </li></div>
<a name="wp3015250"> </a><div class="pSmartList2"><li>In the <b class="cBold">Parameter Type</b> cell, enter the type of parameter. Here, the parameter is a whole number, hence, select <b class="cBold">Int</b> from the list.</li></div>
<a name="wp3015258"> </a><div class="pSmartList2"><li>In the <b class="cBold">Parameter Value</b> cell, enter the parameter value. Here, we want to retrieve the name of the State based on the State ID for every client in the input file. Hence, enter &quot;<code class="cCode">row1.idState</code>&quot;.</li></div>
<a name="wp3015268"> </a><div class="pSmartList2"><li>Double click <b class="cBold">tParseRecordSet</b> to set its properties in the <b class="cBold">Basic settings</b> tab of the <b class="cBold">Component</b> view.</li></div>
</ul></div>
</ul></div>
<a name="wp3015283"> </a><div style="color: #000000; font-size: 2pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 0pt; margin-left: 0pt; margin-right: 0pt; margin-top: 0pt; text-align: left; text-decoration: none; text-indent: 0pt; text-transform: none">
</div>
<div align="center"><img src="../Images/Use_Case_tMySQLRow2_6.png" id="wp3015280" border="0" hspace="0" vspace="0"/></div><div style="color: #000000; font-size: 2pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 0pt; margin-left: 0pt; margin-right: 0pt; margin-top: 0pt; text-align: left; text-decoration: none; text-indent: 0pt; text-transform: none">

</div>
<div class="pSmartList1"><ul class="pSmartList1">
<div class="pSmartList2"><ul class="pSmartList2">
<a name="wp3015291"> </a><div class="pSmartList2"><li>From the <b class="cBold">Prev. Comp. Column list</b>, select the preceding components column for analysis. In this example, select <em class="cEmphasis">LabelStateRecordSet</em>.</li></div>
<a name="wp3015301"> </a><div class="pSmartList2"><li>Click on the <b class="cBold">Sync columns</b> button to retrieve the schema from the preceding component. The <b class="cBold">Attribute table</b> is automatically completed with the schema columns.</li></div>
<a name="wp3015314"> </a><div class="pSmartList2"><li>In the <b class="cBold">Attribute table</b>, in the <b class="cBold">Value</b> field which corresponds to the <em class="cEmphasis">LabelStateRecordSet</em>, enter the name of the column containing the State names to be retrieved and matched with each client, within double quotation marks. In this example, enter &quot;<em class="cEmphasis">LabelState</em>&quot;.</li></div>
<a name="wp3015327"> </a><div class="pSmartList2"><li>Double click <b class="cBold">tFileOutputDelimited</b> to set its properties in the <b class="cBold">Basic settings</b> tab of the <b class="cBold">Component</b> view.  </li></div>
</ul></div>
</ul></div>
<a name="wp3015342"> </a><div style="color: #000000; font-size: 2pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 0pt; margin-left: 0pt; margin-right: 0pt; margin-top: 0pt; text-align: left; text-decoration: none; text-indent: 0pt; text-transform: none">
</div>
<div align="center"><img src="../Images/Use_Case_tMySQLRow2_7.png" id="wp3015339" border="0" hspace="0" vspace="0"/></div><div style="color: #000000; font-size: 2pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 0pt; margin-left: 0pt; margin-right: 0pt; margin-top: 0pt; text-align: left; text-decoration: none; text-indent: 0pt; text-transform: none">

</div>
<div class="pSmartList1"><ul class="pSmartList1">
<div class="pSmartList2"><ul class="pSmartList2">
<a name="wp3015351"> </a><div class="pSmartList2"><li>In the <b class="cBold">File Name field</b>, enter the access path and name of the output file.</li></div>
<a name="wp3015358"> </a><div class="pSmartList2"><li>Click <b class="cBold">Sync columns</b> to retrieve the schema from the preceding component.</li></div>
<a name="wp3015366"> </a><div class="pSmartList2"><li>Save your Job and press <b class="cBold">F6</b> to run it.  </li></div>
</ul></div>
</ul></div>
<a name="wp3015373"> </a><div style="color: #000000; font-size: 2pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 0pt; margin-left: 0pt; margin-right: 0pt; margin-top: 0pt; text-align: left; text-decoration: none; text-indent: 0pt; text-transform: none">
</div>
<div align="center"><img src="../Images/Use_Case_tMySQLRow2_8.png" id="wp3015370" border="0" hspace="0" vspace="0"/></div><div style="color: #000000; font-size: 2pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 0pt; margin-left: 0pt; margin-right: 0pt; margin-top: 0pt; text-align: left; text-decoration: none; text-indent: 0pt; text-transform: none">

</div>
<a name="wp3015376"> </a><p class="pIndented1">
A column containing the name of the American State corrresponding to each client is added to the file.
</p>
    </blockquote>
    <hr>

    <!--table align="right" border="0" cellspacing="0" cellpadding="0">
      <tr>
        <td align="right"><font size="1">
          <a href="http://www.webworks.com"><img src="images/webworks.gif" width="150" height="20" border="0"></a><br>
            Quadralay Corporation<br>
            http://www.webworks.com<br>
            Voice: (512) 719-3399<br>
            Fax: (512) 719-3606<br>
          <a href="mailto:sales@webworks.com">sales@webworks.com</a><br>
        </font></td>
      </tr>
    </table-->

    <!--table width="220" border="0" cellpadding="0" cellspacing="0">
      <tr> 
        <td>
<a accesskey="4" href="tMysqlRow_Prop.html"><img id="LongDescNotReq3" src="images/prev.gif" border="0" alt="Previous" /></a><a accesskey="5" href="Components05-276.html"><img id="LongDescNotReq4" src="images/next.gif" border="0" alt="Next" /></a>
        </td>
      </tr>
    </table-->
  </body>
</html>
